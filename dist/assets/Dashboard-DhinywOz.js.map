{"version":3,"file":"Dashboard-DhinywOz.js","sources":["../../src/pages/Dashboard.tsx"],"sourcesContent":["import { Layout } from \"@/components/Layout\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Truck, AlertCircle, CheckCircle, Clock, ArrowRight, Wrench } from \"lucide-react\";\r\nimport { StatCard } from \"@/components/StatCard\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { toast } from \"sonner\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useEffect } from \"react\";\r\n\r\nconst Dashboard = () => {\r\n  const navigate = useNavigate();\r\n  const { canAccessModule, roles, loading } = useAuth();\r\n\r\n  // Redirecionar mecânicos que tentam acessar o dashboard\r\n  useEffect(() => {\r\n    if (loading) return;\r\n    \r\n    const onlyMechanic = roles.length > 0 && roles.every(r => \r\n      r === 'fleet_maintenance' || r === 'maintenance_assistant'\r\n    );\r\n    \r\n    if (onlyMechanic) {\r\n      navigate('/mechanic', { replace: true });\r\n    }\r\n  }, [roles, loading, navigate]);\r\n\r\n\r\n  // Buscar veículos ativos\r\n  const { data: vehicles = [] } = useQuery({\r\n    queryKey: ['active-vehicles'],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('vehicles')\r\n        .select('*')\r\n        .eq('status', 'Ativo')\r\n        .limit(50);\r\n      \r\n      if (error) throw error;\r\n      \r\n      // Transformar para o formato do mapa\r\n      return (data || []).map((v: any) => ({\r\n        id: v.id,\r\n        placa: v.plate,\r\n        posicao: {\r\n          lat: -8.1137 + (Math.random() - 0.5) * 0.5, // Região de Recife\r\n          lng: -34.9005 + (Math.random() - 0.5) * 0.5\r\n        },\r\n        status: v.status,\r\n        statusColor: v.status === 'Ativo' ? 'green' : 'gray'\r\n      }));\r\n    }\r\n  });\r\n\r\n  return (\r\n    <Layout>\r\n      <div className=\"space-y-8\">\r\n        <div className=\"space-y-1\">\r\n          <h1 className=\"text-4xl font-bold tracking-tight text-foreground\">Dashboard Geral</h1>\r\n          <p className=\"text-base text-muted-foreground\">\r\n            Visão geral da operação logística e indicadores de performance\r\n          </p>\r\n        </div>\r\n\r\n        {/* Quick Stats */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          <StatCard \r\n            title=\"Veículos Ativos\" \r\n            value=\"24\" \r\n            icon={Truck}\r\n            trend={{ value: \"+2 esta semana\", positive: true }}\r\n          />\r\n          <StatCard \r\n            title=\"Ordens Pendentes\" \r\n            value=\"12\" \r\n            icon={AlertCircle}\r\n          />\r\n          <StatCard \r\n            title=\"Entregas Hoje\" \r\n            value=\"38\" \r\n            icon={CheckCircle}\r\n            trend={{ value: \"+15%\", positive: true }}\r\n          />\r\n          <StatCard \r\n            title=\"Horas Trabalhadas\" \r\n            value=\"1.2k\" \r\n            icon={Clock}\r\n          />\r\n        </div>\r\n\r\n        {/* Acesso Rápido aos Principais Módulos */}\r\n        <div className=\"grid md:grid-cols-2 gap-6\">\r\n          {/* Card App Motorista */}\r\n          <Card \r\n            className=\"border border-info/20 bg-gradient-to-br from-info/5 to-info/10 hover:border-info/40 hover:shadow-lg transition-all duration-300 cursor-pointer group\"\r\n            onClick={() => navigate('/driver')}\r\n          >\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                <div className=\"bg-info w-12 h-12 rounded-xl flex items-center justify-center shadow-md\">\r\n                  <Truck className=\"w-6 h-6 text-info-foreground\" />\r\n                </div>\r\n                <ArrowRight className=\"w-5 h-5 text-info group-hover:translate-x-1 transition-transform\" />\r\n              </div>\r\n              \r\n              <h3 className=\"text-xl font-bold mb-2 text-foreground\">App Motorista</h3>\r\n              <p className=\"text-sm text-muted-foreground mb-4\">\r\n                Gerencie viagens, check-lists e ganhos em tempo real\r\n              </p>\r\n              \r\n              <div className=\"flex flex-wrap gap-2\">\r\n                <span className=\"text-xs px-3 py-1 rounded-full bg-info/15 text-info border border-info/20\">Check-in/out</span>\r\n                <span className=\"text-xs px-3 py-1 rounded-full bg-info/15 text-info border border-info/20\">Rotas</span>\r\n                <span className=\"text-xs px-3 py-1 rounded-full bg-info/15 text-info border border-info/20\">Financeiro</span>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Card Hub Mecânico */}\r\n          <Card \r\n            className=\"border border-accent/20 bg-gradient-to-br from-accent/5 to-accent/10 hover:border-accent/40 hover:shadow-lg transition-all duration-300 cursor-pointer group\"\r\n            onClick={() => navigate('/mechanic')}\r\n          >\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                <div className=\"bg-accent w-12 h-12 rounded-xl flex items-center justify-center shadow-md\">\r\n                  <Wrench className=\"w-6 h-6 text-accent-foreground\" />\r\n                </div>\r\n                <ArrowRight className=\"w-5 h-5 text-accent group-hover:translate-x-1 transition-transform\" />\r\n              </div>\r\n              \r\n              <h3 className=\"text-xl font-bold mb-2 text-foreground\">Hub Mecânico</h3>\r\n              <p className=\"text-sm text-muted-foreground mb-4\">\r\n                Controle ordens de serviço, manutenções e TPMS\r\n              </p>\r\n              \r\n              <div className=\"flex flex-wrap gap-2\">\r\n                <span className=\"text-xs px-3 py-1 rounded-full bg-accent/15 text-accent border border-accent/20\">O.S.</span>\r\n                <span className=\"text-xs px-3 py-1 rounded-full bg-accent/15 text-accent border border-accent/20\">Manutenção</span>\r\n                <span className=\"text-xs px-3 py-1 rounded-full bg-accent/15 text-accent border border-accent/20\">Pneus</span>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Mapa de Rastreamento - Temporariamente Desabilitado */}\r\n        <Card className=\"overflow-hidden\">\r\n          <CardContent className=\"p-6 text-center\">\r\n            <Truck className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\r\n            <h3 className=\"text-lg font-semibold\">Rastreamento Temporariamente Desabilitado</h3>\r\n            <p className=\"text-sm text-muted-foreground mt-2\">\r\n              Sistema em testes. Acesse o módulo de Rastreamento para ver veículos.\r\n            </p>\r\n            <div className=\"mt-4\">\r\n              <Button variant=\"outline\" onClick={() => navigate('/live-tracking')}>Abrir Live Tracking</Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"names":["Dashboard","navigate","useNavigate","canAccessModule","roles","loading","useAuth","useEffect","length","every","r","replace","data","vehicles","useQuery","queryKey","queryFn","error","supabase","from","select","eq","limit","map","v","id","placa","plate","posicao","lat","Math","random","lng","status","statusColor","Layout","jsxs","jsx","StatCard","Truck","value","positive","AlertCircle","CheckCircle","Clock","Card","CardContent","ArrowRight","Wrench","Button"],"mappings":"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"}