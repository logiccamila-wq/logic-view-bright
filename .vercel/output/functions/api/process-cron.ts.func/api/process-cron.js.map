{"version":3,"file":"process-cron.ts","sources":["C:\\Users\\Camila Lareste\\Documents\\logic-view-bright-main\\logic-view-bright-main\\api\\process-cron.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,YAAY,EAAE,MAAM,uBAAuB,CAAC;AAErD,MAAM,CAAC,OAAO,CAAC,KAAK,UAAU,OAAO,CAAC,GAAQ,EAAE,GAAQ;IACtD,MAAM,QAAQ,GAAG,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,EAAE,EAAE,OAAO,CAAC,GAAG,CAAC,yBAAyB,IAAI,EAAE,CAAC,CAAC;IAC3G,MAAM,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,CAAC;IACrC,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,MAAM,QAAQ;SACrC,IAAI,CAAC,iBAAiB,CAAC;SACvB,MAAM,CAAC,iCAAiC,CAAC;SACzC,EAAE,CAAC,UAAU,EAAE,GAAG,CAAC;SACnB,GAAG,CAAC,QAAQ,EAAE,WAAW,CAAC;SAC1B,KAAK,CAAC,GAAG,CAAC,CAAC;IACd,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ;SACtC,IAAI,CAAC,kBAAkB,CAAC;SACxB,MAAM,CAAC,gDAAgD,CAAC;SACxD,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC;SACf,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC;SACpB,KAAK,CAAC,GAAG,CAAC,CAAC;IAEd,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,MAAM,EAAE,QAAQ,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;AAC9G,CAAC","sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nexport default async function handler(req: any, res: any) {\n  const supabase = createClient(process.env.SUPABASE_URL || \"\", process.env.SUPABASE_SERVICE_ROLE_KEY || \"\");\n  const now = new Date().toISOString();\n  const { data: overdue } = await supabase\n    .from(\"process_actions\")\n    .select(\"id,title,module,due_date,status\")\n    .lt(\"due_date\", now)\n    .neq(\"status\", \"completed\")\n    .limit(200);\n  const { data: critical } = await supabase\n    .from(\"non_conformities\")\n    .select(\"id,description,module,vehicle_plate,rpn,status\")\n    .gte(\"rpn\", 200)\n    .eq(\"status\", \"open\")\n    .limit(200);\n\n  res.status(200).json({ success: true, overdue: (overdue || []).length, critical: (critical || []).length });\n}\n"]}