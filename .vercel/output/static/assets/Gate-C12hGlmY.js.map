{"version":3,"file":"Gate-C12hGlmY.js","sources":["../../src/pages/Gate.tsx"],"sourcesContent":["import { Layout } from \"@/components/Layout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { VehicleSelect } from \"@/components/VehicleSelect\";\nimport { useState } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { toast } from \"sonner\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\nexport default function Gate() {\n  const [plate, setPlate] = useState(\"\");\n  const [driver, setDriver] = useState(\"\");\n  const [kind, setKind] = useState<\"entry\"|\"exit\">(\"entry\");\n  const [odometer, setOdometer] = useState(\"\");\n  const [reason, setReason] = useState(\"\");\n  const [authorizedBy, setAuthorizedBy] = useState(\"\");\n  const [isVisitor, setIsVisitor] = useState(false);\n  const [loading, setLoading] = useState(false);\n\n  const submit = async () => {\n    if (!plate) {\n      toast.error(\"Informe a placa\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const { error } = await supabase.from('gate_events').insert({\n        vehicle_plate: plate,\n        driver_name: driver,\n        direction: kind,\n        odometer: odometer ? parseInt(odometer) : null,\n        reason: reason,\n        authorized_by: authorizedBy,\n        is_visitor: isVisitor\n      } as any);\n\n      if (error) throw error;\n      toast.success(\"Evento registrado com sucesso\");\n      \n      // Reset form\n      setPlate(\"\"); \n      setDriver(\"\"); \n      setKind(\"entry\");\n      setOdometer(\"\");\n      setReason(\"\");\n      setAuthorizedBy(\"\");\n      setIsVisitor(false);\n    } catch (e: any) {\n      console.error(e);\n      toast.error(e?.message || \"Erro ao registrar\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Portaria</h1>\n          <p className=\"text-muted-foreground\">Entrada/Saída de veículos e custo operacional</p>\n        </div>\n        <Card>\n          <CardHeader>\n            <CardTitle>Registro de Evento</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Switch id=\"visitor\" checked={isVisitor} onCheckedChange={setIsVisitor} />\n              <Label htmlFor=\"visitor\">Visitante / Veículo Externo</Label>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Placa do Veículo</Label>\n                {isVisitor ? (\n                  <Input \n                    placeholder=\"Digite a placa\" \n                    value={plate} \n                    onChange={(e) => setPlate(e.target.value.toUpperCase())}\n                  />\n                ) : (\n                  <VehicleSelect \n                    value={plate} \n                    onChange={setPlate}\n                    placeholder=\"Selecione a placa\"\n                  />\n                )}\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Tipo de Movimento</Label>\n                <Select value={kind} onValueChange={(v: any) => setKind(v)}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"entry\">Entrada</SelectItem>\n                    <SelectItem value=\"exit\">Saída</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Motorista</Label>\n                <Input \n                  placeholder=\"Nome do motorista\" \n                  value={driver} \n                  onChange={(e) => setDriver(e.target.value)} \n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Hodômetro (km)</Label>\n                <Input \n                  type=\"number\" \n                  placeholder=\"0\" \n                  value={odometer} \n                  onChange={(e) => setOdometer(e.target.value)} \n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Quem Autorizou</Label>\n                <Input \n                  placeholder=\"Nome do autorizador\" \n                  value={authorizedBy} \n                  onChange={(e) => setAuthorizedBy(e.target.value)} \n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Motivo / Observações</Label>\n              <Textarea \n                placeholder=\"Motivo da entrada/saída\" \n                value={reason} \n                onChange={(e) => setReason(e.target.value)} \n              />\n            </div>\n\n            <Button onClick={submit} disabled={loading} className=\"w-full md:w-auto\">\n              {loading ? \"Registrando...\" : \"Registrar Evento\"}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    </Layout>\n  );\n}\n"],"names":["Gate","plate","setPlate","useState","driver","setDriver","kind","setKind","odometer","setOdometer","reason","setReason","authorizedBy","setAuthorizedBy","isVisitor","setIsVisitor","loading","setLoading","submit","toast","error","supabase","from","insert","vehicle_plate","driver_name","direction","parseInt","authorized_by","is_visitor","success","e","console","message","Layout","jsxs","jsx","Card","CardHeader","CardTitle","CardContent","Switch","Label","Input","target","value","toUpperCase","VehicleSelect","Select","v","SelectTrigger","SelectValue","SelectContent","SelectItem","Textarea","Button"],"mappings":"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"}