{"version":3,"file":"CentrosCusto-DGwrdiWp.js","sources":["../../src/pages/CentrosCusto.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { Layout } from \"@/components/Layout\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Plus, Edit, Trash2, Search } from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\nimport { listCentrosCusto, createCentroCusto, updateCentroCusto, deleteCentroCusto } from \"@/lib/db/centrosCusto\";\r\nimport type { CentroCusto } from \"@/types/financeiro\";\r\n\r\nexport default function CentrosCusto() {\r\n  const [centros, setCentros] = useState<CentroCusto[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [dialogOpen, setDialogOpen] = useState(false);\r\n  const [editingCentro, setEditingCentro] = useState<CentroCusto | null>(null);\r\n  const [formData, setFormData] = useState({\r\n    codigo: \"\",\r\n    nome: \"\",\r\n    descricao: \"\",\r\n    status: \"ativo\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    loadCentros();\r\n  }, []);\r\n\r\n  async function loadCentros() {\r\n    try {\r\n      setLoading(true);\r\n      const data = await listCentrosCusto();\r\n      setCentros(data);\r\n    } catch (error: any) {\r\n      toast.error(\"Erro ao carregar centros de custo\");\r\n      console.error(error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  function handleEdit(centro: CentroCusto) {\r\n    setEditingCentro(centro);\r\n    setFormData({\r\n      codigo: centro.codigo,\r\n      nome: centro.nome,\r\n      descricao: centro.descricao || \"\",\r\n      status: centro.status,\r\n    });\r\n    setDialogOpen(true);\r\n  }\r\n\r\n  function handleNew() {\r\n    setEditingCentro(null);\r\n    setFormData({\r\n      codigo: \"\",\r\n      nome: \"\",\r\n      descricao: \"\",\r\n      status: \"ativo\",\r\n    });\r\n    setDialogOpen(true);\r\n  }\r\n\r\n  async function handleSubmit() {\r\n    try {\r\n      if (editingCentro) {\r\n        await updateCentroCusto(editingCentro.id, formData);\r\n        toast.success(\"Centro de custo atualizado\");\r\n      } else {\r\n        await createCentroCusto(formData);\r\n        toast.success(\"Centro de custo criado\");\r\n      }\r\n      setDialogOpen(false);\r\n      loadCentros();\r\n    } catch (error: any) {\r\n      toast.error(error.message || \"Erro ao salvar centro de custo\");\r\n    }\r\n  }\r\n\r\n  async function handleDelete(id: string) {\r\n    if (!confirm(\"Deseja realmente excluir este centro de custo?\")) return;\r\n\r\n    try {\r\n      await deleteCentroCusto(id);\r\n      toast.success(\"Centro de custo excluído\");\r\n      loadCentros();\r\n    } catch (error: any) {\r\n      toast.error(error.message || \"Erro ao excluir centro de custo\");\r\n    }\r\n  }\r\n\r\n  const filteredCentros = centros.filter(\r\n    (c) =>\r\n      c.codigo.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      c.nome.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <Layout>\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <h1 className=\"text-3xl font-bold\">Centros de Custo</h1>\r\n          <Button onClick={handleNew}>\r\n            <Plus className=\"mr-2 h-4 w-4\" />\r\n            Novo Centro de Custo\r\n          </Button>\r\n        </div>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Buscar por código ou nome...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"max-w-sm\"\r\n              />\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {loading ? (\r\n              <p className=\"text-center text-muted-foreground\">Carregando...</p>\r\n            ) : (\r\n              <div className=\"space-y-2\">\r\n                {filteredCentros.map((centro) => (\r\n                  <div\r\n                    key={centro.id}\r\n                    className=\"flex items-center justify-between p-4 border rounded-lg\"\r\n                  >\r\n                    <div>\r\n                      <p className=\"font-semibold\">{centro.codigo} - {centro.nome}</p>\r\n                      {centro.descricao && (\r\n                        <p className=\"text-sm text-muted-foreground\">{centro.descricao}</p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => handleEdit(centro)}>\r\n                        <Edit className=\"h-4 w-4\" />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleDelete(centro.id)}\r\n                      >\r\n                        <Trash2 className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {editingCentro ? \"Editar\" : \"Novo\"} Centro de Custo\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <Label>Código</Label>\r\n              <Input\r\n                value={formData.codigo}\r\n                onChange={(e) => setFormData({ ...formData, codigo: e.target.value })}\r\n                placeholder=\"CC001\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <Label>Nome</Label>\r\n              <Input\r\n                value={formData.nome}\r\n                onChange={(e) => setFormData({ ...formData, nome: e.target.value })}\r\n                placeholder=\"Administrativo\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <Label>Descrição</Label>\r\n              <Textarea\r\n                value={formData.descricao}\r\n                onChange={(e) => setFormData({ ...formData, descricao: e.target.value })}\r\n                placeholder=\"Descrição do centro de custo\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setDialogOpen(false)}>\r\n              Cancelar\r\n            </Button>\r\n            <Button onClick={handleSubmit}>Salvar</Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </Layout>\r\n  );\r\n}\r\n"],"names":["CentrosCusto","centros","setCentros","useState","loading","setLoading","searchTerm","setSearchTerm","dialogOpen","setDialogOpen","editingCentro","setEditingCentro","formData","setFormData","codigo","nome","descricao","status","useEffect","loadCentros","data","listCentrosCusto","error","toast","console","handleEdit","centro","handleNew","handleSubmit","updateCentroCusto","id","success","createCentroCusto","message","handleDelete","confirm","deleteCentroCusto","filteredCentros","filter","c","toLowerCase","includes","Layout","jsxs","jsx","Button","Plus","Card","CardHeader","Search","Input","e","target","value","CardContent","map","Edit","Trash2","Dialog","DialogContent","DialogHeader","DialogTitle","Label","Textarea","DialogFooter"],"mappings":"6lBAaA,SAAwBA,IAAe,CACrC,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAwB,CAAA,CAAE,EAClD,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAAYC,CAAa,EAAIJ,EAAAA,SAAS,EAAE,EACzC,CAACK,EAAYC,CAAa,EAAIN,EAAAA,SAAS,EAAK,EAC5C,CAACO,EAAeC,CAAgB,EAAIR,EAAAA,SAA6B,IAAI,EACrE,CAACS,EAAUC,CAAW,EAAIV,WAAS,CACvCW,OAAQ,GACRC,KAAM,GACNC,UAAW,GACXC,OAAQ,OAAA,CACT,EAEDC,EAAAA,UAAU,IAAM,CACdC,EAAAA,CACF,EAAG,CAAA,CAAE,EAEL,eAAeA,GAAc,CAC3B,GAAI,CACFd,EAAW,EAAI,EACf,MAAMe,EAAO,MAAMC,EAAAA,EACnBnB,EAAWkB,CAAI,CACjB,OAASE,EAAY,CACnBC,EAAMD,MAAM,mCAAmC,EAC/CE,QAAQF,MAAMA,CAAK,CACrB,QAAA,CACEjB,EAAW,EAAK,CAClB,CACF,CAEA,SAASoB,EAAWC,EAAqB,CACvCf,EAAiBe,CAAM,EACvBb,EAAY,CACVC,OAAQY,EAAOZ,OACfC,KAAMW,EAAOX,KACbC,UAAWU,EAAOV,WAAa,GAC/BC,OAAQS,EAAOT,MAAAA,CAChB,EACDR,EAAc,EAAI,CACpB,CAEA,SAASkB,GAAY,CACnBhB,EAAiB,IAAI,EACrBE,EAAY,CACVC,OAAQ,GACRC,KAAM,GACNC,UAAW,GACXC,OAAQ,OAAA,CACT,EACDR,EAAc,EAAI,CACpB,CAEA,eAAemB,GAAe,CAC5B,GAAI,CACElB,GACF,MAAMmB,EAAkBnB,EAAcoB,GAAIlB,CAAQ,EAClDW,EAAMQ,QAAQ,4BAA4B,IAE1C,MAAMC,EAAkBpB,CAAQ,EAChCW,EAAMQ,QAAQ,wBAAwB,GAExCtB,EAAc,EAAK,EACnBU,EAAAA,CACF,OAASG,EAAY,CACnBC,EAAMD,MAAMA,EAAMW,SAAW,gCAAgC,CAC/D,CACF,CAEA,eAAeC,EAAaJ,EAAY,CACtC,GAAKK,QAAQ,gDAAgD,EAE7D,GAAI,CACF,MAAMC,EAAkBN,CAAE,EAC1BP,EAAMQ,QAAQ,0BAA0B,EACxCZ,EAAAA,CACF,OAASG,EAAY,CACnBC,EAAMD,MAAMA,EAAMW,SAAW,iCAAiC,CAChE,CACF,CAEA,MAAMI,EAAkBpC,EAAQqC,OAC7BC,GACCA,EAAEzB,OAAO0B,YAAAA,EAAcC,SAASnC,EAAWkC,aAAa,GACxDD,EAAExB,KAAKyB,YAAAA,EAAcC,SAASnC,EAAWkC,YAAAA,CAAa,CAC1D,EAEA,cACGE,EAAA,CACC,SAAA,CAAAC,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,IAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAAC,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,IAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAAC,UAAU,oCACb,SAAA,CAAAC,MAAC,KAAA,CAAE,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uTAAC,UAAU,qBAAqB,SAAA,mBAAgB,EACnDD,EAAAA,KAACE,EAAA,CAAO,QAASlB,EACf,SAAA,CAAAiB,EAAAA,IAACE,EAAA,CAAK,UAAU,cAAA,CAAc,EAAG,sBAAA,CAAA,CAEnC,CAAA,EACF,SAECC,EAAA,CACC,SAAA,CAAAH,MAACI,GACC,SAAAL,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAAC,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAO,UAAU,+BAAA,CAA+B,EACjDL,EAAAA,IAACM,EAAA,CACC,YAAY,+BACZ,MAAO5C,EACP,SAAW6C,GAAM5C,EAAc4C,EAAEC,OAAOC,KAAK,EAC7C,UAAU,UAAA,CAAU,CAAA,CAAA,CAExB,CAAA,CACF,EACAT,EAAAA,IAACU,EAAA,CACElD,SAAAA,EACCwC,EAAAA,IAAC,IAAA,CAAC,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,gTAAC,UAAU,oCAAoC,SAAA,eAAA,CAAa,EAE9DA,EAAAA,IAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAAC,UAAU,YACZP,SAAAA,EAAgBkB,IAAK7B,GACpBiB,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAEF,UAAU,0DAEV,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIACF,SAAA,CAAAA,EAAAA,KAAC,IAAA,CAAC,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAAC,UAAU,gBAAiBjB,SAAAA,CAAAA,EAAOZ,OAAO,MAAIY,EAAOX,IAAAA,EAAK,EAC3DW,EAAOV,WACN4B,EAAAA,IAAC,8WAAE,UAAU,gCAAiClB,WAAOV,SAAAA,CAAU,CAAA,EAEnE,EACA2B,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAAC,UAAU,aACb,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAO,QAAQ,UAAU,KAAK,KAAK,QAAS,IAAMpB,EAAWC,CAAM,EAClE,SAAAkB,MAACY,EAAA,CAAK,UAAU,UAAS,EAC3B,QACCX,EAAA,CACC,QAAQ,UACR,KAAK,KACL,QAAS,IAAMX,EAAaR,EAAOI,EAAE,EAErC,SAAAc,EAAAA,IAACa,EAAA,CAAO,UAAU,UAAS,CAAA,CAC7B,CAAA,CAAA,CACF,CAAA,CAAA,EApBK/B,EAAOI,EAqBd,CACD,CAAA,CACH,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,EACF,QAEC4B,EAAA,CAAO,KAAMlD,EAAY,aAAcC,EACtC,gBAACkD,EAAA,CACC,SAAA,CAAAf,EAAAA,IAACgB,EAAA,CACC,gBAACC,EAAA,CACEnD,SAAAA,CAAAA,EAAgB,SAAW,OAAO,kBAAA,CAAA,CACrC,CAAA,CACF,EACAiC,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIAAC,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIACF,SAAA,CAAAC,EAAAA,IAACkB,GAAM,SAAA,QAAA,CAAM,QACZZ,EAAA,CACC,MAAOtC,EAASE,OAChB,YAAiBD,EAAY,CAAE,GAAGD,EAAUE,OAAQqC,EAAEC,OAAOC,KAAAA,CAAO,EACpE,YAAY,OAAA,CAAO,CAAA,EAEvB,EACAV,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIACF,SAAA,CAAAC,EAAAA,IAACkB,GAAM,SAAA,MAAA,CAAI,QACVZ,EAAA,CACC,MAAOtC,EAASG,KAChB,YAAiBF,EAAY,CAAE,GAAGD,EAAUG,KAAMoC,EAAEC,OAAOC,KAAAA,CAAO,EAClE,YAAY,gBAAA,CAAgB,CAAA,EAEhC,EACAV,EAAAA,KAAC,MAAA,CAAG,4BAAA,MAAA,8BAAA,KAAA,0BAAA,MAAA,4BAAA,KAAA,2BAAA,mCAAA,8BAAA,uIACF,SAAA,CAAAC,EAAAA,IAACkB,GAAM,SAAA,WAAA,CAAS,QACfC,EAAA,CACC,MAAOnD,EAASI,UAChB,YAAiBH,EAAY,CAAE,GAAGD,EAAUI,UAAWmC,EAAEC,OAAOC,KAAAA,CAAO,EACvE,YAAY,8BAAA,CAA8B,CAAA,CAAA,CAE9C,CAAA,EACF,SACCW,EAAA,CACC,SAAA,CAAApB,EAAAA,IAACC,EAAA,CAAO,QAAQ,UAAU,QAAS,IAAMpC,EAAc,EAAK,EAAG,SAAA,UAAA,CAE/D,EACAmC,EAAAA,IAACC,EAAA,CAAO,QAASjB,EAAc,SAAA,QAAA,CAAM,CAAA,CAAA,CACvC,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAEJ"}