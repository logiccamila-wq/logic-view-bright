async function safeJson(r) {
  const ct = r.headers.get('content-type') || ''
  if (!r.ok) throw new Error(`HTTP ${r.status}`)
  if (!ct.includes('application/json')) throw new Error('Resposta n√£o JSON')
  return r.json()
}